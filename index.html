<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…ØªØªØ¨Ø¹ Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù‚Ø±Ø¢Ù† - Ù£Ù  ÙŠÙˆÙ…Ø§Ù‹</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Amiri:wght@400;700&family=Cairo:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Cairo', sans-serif; }
        .arabic { font-family: 'Amiri', serif; }
        .checkbox-animate { transition: all 0.2s ease; }
        .checkbox-animate:checked { transform: scale(1.1); }
        .day-cell { min-width: 40px; }
        .table-container { 
            overflow-x: auto; 
            -webkit-overflow-scrolling: touch;
            scrollbar-width: thin;
            scrollbar-color: #10b981 #e5e7eb;
        }
        .table-container::-webkit-scrollbar {
            height: 8px;
        }
        .table-container::-webkit-scrollbar-track {
            background: #e5e7eb;
            border-radius: 4px;
        }
        .table-container::-webkit-scrollbar-thumb {
            background: #10b981;
            border-radius: 4px;
        }
        @media (max-width: 768px) {
            .day-cell { min-width: 35px; }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-emerald-50 to-teal-100 min-h-screen">
    <div class="container mx-auto px-4 py-8 max-w-7xl">
        <!-- Header -->
        <div class="text-center mb-8">
            <h1 class="text-4xl md:text-5xl font-bold text-emerald-800 mb-2 arabic">ğŸ“– Ù…ØªØªØ¨Ø¹ Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù‚Ø±Ø¢Ù†</h1>
            <p class="text-emerald-600 text-lg">Ù£Ù  ÙŠÙˆÙ…Ø§Ù‹ Ù…Ù† Ø§Ù„Ø®ÙŠØ±Ø§Øª - Ø¬Ø¯ÙˆÙ„ Ù‚Ø±Ø§Ø¡Ø© Ø±Ù…Ø¶Ø§Ù†</p>
            <div class="mt-4 inline-flex items-center gap-2 bg-white px-4 py-2 rounded-full shadow-sm">
                <span class="text-sm text-gray-600">Ø§Ù„ØªÙ‚Ø¯Ù… Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ:</span>
                <span id="totalProgress" class="font-bold text-emerald-700">Ù Ùª</span>
            </div>
        </div>

        <!-- Add Reader Form -->
        <div class="bg-white rounded-2xl shadow-lg p-6 mb-6">
            <div class="flex flex-col sm:flex-row gap-3">
                <input type="text" id="newReaderName" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø§Ø³Ù…..." 
                    class="flex-1 px-4 py-3 border-2 border-emerald-200 rounded-xl focus:outline-none focus:border-emerald-500 text-gray-700 text-right">
                <button onclick="addReader()" 
                    class="px-6 py-3 bg-white border-2 border-emerald-600 text-emerald-600 hover:bg-emerald-600 hover:text-white font-semibold rounded-xl transition-colors">
                    + Ø¥Ø¶Ø§ÙØ© Ù‚Ø§Ø±Ø¦
                </button>
            </div>
        </div>

        <!-- Readers Table -->
        <div class="bg-white rounded-2xl shadow-lg overflow-hidden">
            <div class="table-container">
                <table class="w-full">
                    <thead class="bg-emerald-600 text-white">
                        <tr id="tableHeaderRow">
                            <th class="px-4 py-4 text-right font-semibold sticky right-0 bg-emerald-600 z-10">Ø§Ø³Ù… Ø§Ù„Ù‚Ø§Ø±Ø¦</th>
                            <th class="px-2 py-4 text-center font-semibold">Ø§Ù„ØªÙ‚Ø¯Ù…</th>
                            <!-- 30 Day headers will be inserted here -->
                            <th class="px-3 py-4 text-center font-semibold">Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                        </tr>
                    </thead>
                    <tbody id="readersTableBody" class="divide-y divide-emerald-100">
                        <!-- Readers rows generated by JS -->
                    </tbody>
                </table>
            </div>
            
            <!-- Empty State -->
            <div id="emptyState" class="hidden py-12 text-center">
                <p class="text-gray-500 text-lg">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù‚Ø±Ø§Ø¡ Ø¨Ø¹Ø¯. Ø£Ø¶Ù Ù‚Ø§Ø±Ø¦Ùƒ Ø§Ù„Ø£ÙˆÙ„ Ø£Ø¹Ù„Ø§Ù‡!</p>
            </div>
        </div>

        <!-- Legend -->
        <div class="mt-6 flex flex-wrap justify-center gap-4 text-sm">
            <div class="flex items-center gap-2 bg-white px-3 py-2 rounded-lg shadow-sm">
                <div class="w-5 h-5 bg-emerald-500 rounded"></div>
                <span class="text-gray-600">ØªÙ…Øª Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©</span>
            </div>
            <div class="flex items-center gap-2 bg-white px-3 py-2 rounded-lg shadow-sm">
                <div class="w-5 h-5 bg-gray-200 rounded"></div>
                <span class="text-gray-600">Ù„Ù… ØªÙ‚Ø±Ø£ Ø¨Ø¹Ø¯</span>
            </div>
        </div>

        <!-- Footer -->
        <div class="mt-8 text-center text-emerald-600 text-sm">
            <p>Ø¬Ø²Ø§Ùƒ Ø§Ù„Ù„Ù‡ Ø®ÙŠØ±Ø§Ù‹ Ø¹Ù„Ù‰ Ù‚Ø±Ø§Ø¡ØªÙƒ ÙˆØ¶Ø§Ø¹Ù Ù„Ùƒ Ø§Ù„Ø£Ø¬Ø± ğŸŒ™</p>
        </div>
    </div>

    <script>
        const DAYS_COUNT = 30;
        let readers = JSON.parse(localStorage.getItem('quranReaders')) || [];

        function saveData() {
            localStorage.setItem('quranReaders', JSON.stringify(readers));
            updateTotalProgress();
        }

        function addReader() {
            const nameInput = document.getElementById('newReaderName');
            const name = nameInput.value.trim();
            
            if (!name) {
                alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù…');
                return;
            }
            
            const newReader = {
                id: Date.now(),
                name: name,
                progress: Array(DAYS_COUNT).fill(false)
            };
            
            readers.push(newReader);
            saveData();
            renderTable();
            nameInput.value = '';
        }

        function deleteReader(id) {
            const reader = readers.find(r => r.id === id);
            const readerName = reader ? reader.name : '';
            if (confirm(`Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø²Ø§Ù„Ø© "${readerName}" Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©ØŸ`)) {
                readers = readers.filter(r => r.id !== id);
                saveData();
                renderTable();
            }
        }

        function toggleDay(readerId, dayIndex) {
            const reader = readers.find(r => r.id === readerId);
            if (reader) {
                reader.progress[dayIndex] = !reader.progress[dayIndex];
                saveData();
                renderTable();
            }
        }

        function getReaderProgress(reader) {
            const completed = reader.progress.filter(p => p).length;
            return Math.round((completed / DAYS_COUNT) * 100);
        }

        function updateTotalProgress() {
            if (readers.length === 0) {
                document.getElementById('totalProgress').textContent = 'Ù Ùª';
                return;
            }
            const totalCompleted = readers.reduce((sum, reader) => {
                return sum + reader.progress.filter(p => p).length;
            }, 0);
            const totalPossible = readers.length * DAYS_COUNT;
            const percentage = Math.round((totalCompleted / totalPossible) * 100);
            document.getElementById('totalProgress').textContent = percentage + 'Ùª';
        }

        function renderDayHeaders() {
            const headerRow = document.getElementById('tableHeaderRow');
            const progressTh = headerRow.querySelector('th:nth-child(2)');
            const actionsTh = headerRow.querySelector('th:last-child');
            
            // Remove old day headers (between progress and actions)
            let current = progressTh.nextElementSibling;
            while (current && current !== actionsTh) {
                const toRemove = current;
                current = current.nextElementSibling;
                toRemove.remove();
            }
            
            // Add new day headers between progress and actions (order 1-30)
            for (let i = 1; i <= DAYS_COUNT; i++) {
                const th = document.createElement('th');
                th.className = 'day-cell px-1 py-4 text-center font-semibold text-xs';
                th.textContent = i;
                headerRow.insertBefore(th, actionsTh);
            }
        }

        function renderTable() {
            const tbody = document.getElementById('readersTableBody');
            const emptyState = document.getElementById('emptyState');
            
            if (readers.length === 0) {
                tbody.innerHTML = '';
                emptyState.classList.remove('hidden');
                return;
            }
            
            emptyState.classList.add('hidden');
            tbody.innerHTML = '';
            
            readers.forEach((reader, index) => {
                const row = document.createElement('tr');
                row.className = 'hover:bg-emerald-50 transition-colors';
                
                // Name cell (now first)
                const nameCell = document.createElement('td');
                nameCell.className = 'px-4 py-3 font-medium text-gray-800 sticky right-0 bg-white hover:bg-emerald-50 z-10';
                nameCell.innerHTML = `
                    <div class="flex items-center gap-2">
                        <span class="w-7 h-7 bg-emerald-100 text-emerald-700 rounded-full flex items-center justify-center text-sm font-bold">
                            ${index + 1}
                        </span>
                        <span>${reader.name}</span>
                    </div>
                `;
                row.appendChild(nameCell);
                
                // Progress cell
                const progressCell = document.createElement('td');
                progressCell.className = 'px-2 py-3';
                const progressPercent = getReaderProgress(reader);
                const completedDays = reader.progress.filter(p => p).length;
                progressCell.innerHTML = `
                    <div class="flex flex-col items-center">
                        <span class="text-sm font-bold text-emerald-600">${progressPercent}Ùª</span>
                        <span class="text-xs text-gray-500">${completedDays}/Ù£Ù </span>
                        <div class="w-16 h-2 bg-gray-200 rounded-full mt-1 overflow-hidden">
                            <div class="h-full bg-emerald-500 rounded-full" style="width: ${progressPercent}%"></div>
                        </div>
                    </div>
                `;
                row.appendChild(progressCell);
                
                // Day checkboxes (order 1-30)
                for (let i = 0; i < DAYS_COUNT; i++) {
                    const dayCell = document.createElement('td');
                    dayCell.className = 'px-1 py-3 text-center';
                    
                    const isChecked = reader.progress[i];
                    dayCell.innerHTML = `
                        <button onclick="toggleDay(${reader.id}, ${i})" 
                            class="w-8 h-8 rounded-lg checkbox-animate flex items-center justify-center text-lg font-bold
                            ${isChecked ? 'bg-emerald-500 text-white shadow-md' : 'bg-gray-100 text-gray-300 hover:bg-emerald-100'}">
                            ${isChecked ? 'âœ“' : ''}
                        </button>
                    `;
                    row.appendChild(dayCell);
                }
                
                // Actions cell (now last)
                const actionsCell = document.createElement('td');
                actionsCell.className = 'px-3 py-3 text-center';
                actionsCell.innerHTML = `
                    <button onclick="deleteReader(${reader.id})" 
                        class="text-red-400 hover:text-red-600 transition-colors p-2 rounded-lg hover:bg-red-50"
                        title="Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ù‚Ø§Ø±Ø¦">
                        ğŸ—‘ï¸
                    </button>
                `;
                row.appendChild(actionsCell);
                
                tbody.appendChild(row);
            });
        }

        // Allow Enter key to add reader
        document.getElementById('newReaderName').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                addReader();
            }
        });

        // Initialize
        renderDayHeaders();
        renderTable();
        updateTotalProgress();
    </script>
</body>
</html>
